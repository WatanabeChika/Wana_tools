import{_ as Ze,r as ve,o as Je,a as ie,c as ne,b as q,F as ke,d as _e,t as Ve,n as $e,e as et,v as tt,i as rt,p as at,g as it}from"./index-f4425cc5.js";import{F as nt,f as ot,l as st}from"./utils-d39f28cd.js";import{c as lt,L as ct}from"./data-5ae13b0c.js";import"./_commonjsHelpers-de833af9.js";var qe={exports:{}};(function(me,te){(function(R,X,ce,I){var n={URL:R.URL||R.webkitURL||R.mozURL||R.msURL,getUserMedia:function(){var t=ce.getUserMedia||ce.webkitGetUserMedia||ce.mozGetUserMedia||ce.msGetUserMedia;return t&&t.bind(ce)}(),requestAnimFrame:R.requestAnimationFrame||R.webkitRequestAnimationFrame||R.mozRequestAnimationFrame||R.oRequestAnimationFrame||R.msRequestAnimationFrame,requestTimeout:function(e,a){if(e=e||n.noop,a=a||0,!n.requestAnimFrame)return setTimeout(e,a);var i=new Date().getTime(),r=new Object,l=n.requestAnimFrame,s=function o(){var c=new Date().getTime(),v=c-i;v>=a?e.call():r.value=l(o)};return r.value=l(s),r},Blob:R.Blob||R.BlobBuilder||R.WebKitBlobBuilder||R.MozBlobBuilder||R.MSBlobBuilder,btoa:function(){var t=R.btoa||function(e){for(var a="",i=0,r=e.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=void 0,o=void 0,c=void 0,v=void 0,b=void 0,S=void 0,p=void 0;i<r;)s=e.charCodeAt(i++),o=e.charCodeAt(i++),c=e.charCodeAt(i++),v=s>>2,b=(s&3)<<4|o>>4,S=(o&15)<<2|c>>6,p=c&63,isNaN(o)?S=p=64:isNaN(c)&&(p=64),a=a+l.charAt(v)+l.charAt(b)+l.charAt(S)+l.charAt(p);return a};return t?t.bind(R):n.noop}(),isObject:function(e){return e&&Object.prototype.toString.call(e)==="[object Object]"},isEmptyObject:function(e){return n.isObject(e)&&!Object.keys(e).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&typeof e=="function"},isElement:function(e){return e&&e.nodeType===1},isString:function(e){return typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"},isSupported:{canvas:function(){var e=X.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return R.Worker},blob:function(){return n.Blob},Uint8Array:function(){return R.Uint8Array},Uint32Array:function(){return R.Uint32Array},videoCodecs:function(){var t=X.createElement("video"),e={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{t&&t.canPlayType&&(e.mp4=t.canPlayType('video/mp4; codecs="mp4v.20.8"')!=="",e.h264=(t.canPlayType('video/mp4; codecs="avc1.42E01E"')||t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'))!=="",e.ogv=t.canPlayType('video/ogg; codecs="theora"')!=="",e.ogg=t.canPlayType('video/ogg; codecs="theora"')!=="",e.webm=t.canPlayType('video/webm; codecs="vp8, vorbis"')!==-1)}catch{}return e}()},noop:function(){},each:function(e,a){var i=void 0,r=void 0;if(n.isArray(e))for(i=-1,r=e.length;++i<r&&a(i,e[i])!==!1;);else if(n.isObject(e)){for(i in e)if(e.hasOwnProperty(i)&&a(i,e[i])===!1)break}},mergeOptions:function(e,a){if(!(!n.isObject(e)||!n.isObject(a)||!Object.keys)){var i={};return n.each(e,function(r,l){i[r]=e[r]}),n.each(a,function(r,l){var s=a[r];n.isObject(s)&&e[r]?i[r]=n.mergeOptions(e[r],s):i[r]=s}),i}},setCSSAttr:function(e,a,i){n.isElement(e)&&(n.isString(a)&&n.isString(i)?e.style[a]=i:n.isObject(a)&&n.each(a,function(r,l){e.style[r]=l}))},removeElement:function(e){n.isElement(e)&&e.parentNode&&e.parentNode.removeChild(e)},createWebWorker:function(e){if(!n.isString(e))return{};try{var a=new n.Blob([e],{type:"text/javascript"}),i=n.URL.createObjectURL(a),r=new Worker(i);return{objectUrl:i,worker:r}}catch(l){return""+l}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(){var e=arguments.length>0&&arguments[0]!==I?arguments[0]:{};if(!X.body||e.resizeFont===!1)return e.fontSize;var a=e.text,i=e.gifWidth,r=parseInt(e.fontSize,10),l=parseInt(e.minFontSize,10),s=X.createElement("div"),o=X.createElement("span");for(s.setAttribute("width",i),s.appendChild(o),o.innerHTML=a,o.style.fontSize=r+"px",o.style.textIndent="-9999px",o.style.visibility="hidden",X.body.appendChild(o);o.offsetWidth>i&&r>=l;)o.style.fontSize=--r+"px";return X.body.removeChild(o),r+"px"},webWorkerError:!1},de=Object.freeze({default:n}),j={validate:function(e){e=n.isObject(e)?e:{};var a={};return n.each(j.validators,function(i,r){var l=r.errorCode;if(!e[l]&&!r.condition)return a=r,a.error=!0,!1}),delete a.condition,a},isValid:function(e){var a=j.validate(e),i=a.error!==!0;return i},validators:[{condition:n.isFunction(n.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:n.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:n.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:n.isFunction(n.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:n.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:n.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:n.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},oe=Object.freeze({default:j}),fe=function(){},ue={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:fe,completeCallback:fe,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},Ie=Object.freeze({default:ue});function Ae(){return j.isValid()}function ge(){return j.isValid()}function Te(){var t={getUserMedia:!0};return j.isValid(t)}function Ue(t){var e=!1;if(n.isArray(t)&&t.length){if(n.each(t,function(a,i){n.isSupported.videoCodecs[i]&&(e=!0)}),!e)return!1}else if(n.isString(t)&&t.length&&!n.isSupported.videoCodecs[t])return!1;return j.isValid({getUserMedia:!0})}function Se(){var t=256,e=499,a=491,i=487,r=503,l=3*r,s=t-1,o=4,c=100,v=16,b=1<<v,S=10,p=10,f=b>>p,w=b<<S-p,F=t>>3,k=6,_=1<<k,P=F*_,O=30,V=10,G=1<<V,B,Y=8,Q=1<<Y,D=V+Y,L=1<<D,re,H,Z,A,$=[],se=[],ae=[],he=[];function Me(u,g,U){var h,x;for(re=u,H=g,Z=U,A=new Array(t),h=0;h<t;h++)A[h]=new Array(4),x=A[h],x[0]=x[1]=x[2]=(h<<o+8)/t|0,ae[h]=b/t|0,se[h]=0}function pe(){for(var u=[],g=new Array(t),U=0;U<t;U++)g[A[U][3]]=U;for(var h=0,x=0;x<t;x++){var d=g[x];u[h++]=A[d][0],u[h++]=A[d][1],u[h++]=A[d][2]}return u}function xe(){var u,g,U,h,x,d,m,E;for(m=0,E=0,u=0;u<t;u++){for(x=A[u],U=u,h=x[1],g=u+1;g<t;g++)d=A[g],d[1]<h&&(U=g,h=d[1]);if(d=A[U],u!=U&&(g=d[0],d[0]=x[0],x[0]=g,g=d[1],d[1]=x[1],x[1]=g,g=d[2],d[2]=x[2],x[2]=g,g=d[3],d[3]=x[3],x[3]=g),h!=m){for($[m]=E+u>>1,g=m+1;g<h;g++)$[g]=u;m=h,E=u}}for($[m]=E+s>>1,g=m+1;g<256;g++)$[g]=s}function be(){var u,g,U,h,x,d,m,E,T,z,ee,M,J,De;for(H<l&&(Z=1),B=30+(Z-1)/3,M=re,J=0,De=H,ee=H/(3*Z),z=ee/c|0,E=G,d=P,m=d>>k,m<=1&&(m=0),u=0;u<m;u++)he[u]=E*((m*m-u*u)*Q/(m*m));for(H<l?T=3:H%e!==0?T=3*e:H%a!==0?T=3*a:H%i!==0?T=3*i:T=3*r,u=0;u<ee;)if(U=(M[J+0]&255)<<o,h=(M[J+1]&255)<<o,x=(M[J+2]&255)<<o,g=We(U,h,x),Ee(E,g,U,h,x),m!==0&&Fe(m,g,U,h,x),J+=T,J>=De&&(J-=H),u++,z===0&&(z=1),u%z===0)for(E-=E/B,d-=d/O,m=d>>k,m<=1&&(m=0),g=0;g<m;g++)he[g]=E*((m*m-g*g)*Q/(m*m))}function ye(u,g,U){var h,x,d,m,E,T,z;for(E=1e3,z=-1,h=$[g],x=h-1;h<t||x>=0;)h<t&&(T=A[h],d=T[1]-g,d>=E?h=t:(h++,d<0&&(d=-d),m=T[0]-u,m<0&&(m=-m),d+=m,d<E&&(m=T[2]-U,m<0&&(m=-m),d+=m,d<E&&(E=d,z=T[3])))),x>=0&&(T=A[x],d=g-T[1],d>=E?x=-1:(x--,d<0&&(d=-d),m=T[0]-u,m<0&&(m=-m),d+=m,d<E&&(m=T[2]-U,m<0&&(m=-m),d+=m,d<E&&(E=d,z=T[3]))));return z}function Oe(){return be(),Ce(),xe(),pe()}function Ce(){var u;for(u=0;u<t;u++)A[u][0]>>=o,A[u][1]>>=o,A[u][2]>>=o,A[u][3]=u}function Fe(u,g,U,h,x){var d,m,E,T,z,ee,M;for(E=g-u,E<-1&&(E=-1),T=g+u,T>t&&(T=t),d=g+1,m=g-1,ee=1;d<T||m>E;){if(z=he[ee++],d<T){M=A[d++];try{M[0]-=z*(M[0]-U)/L|0,M[1]-=z*(M[1]-h)/L|0,M[2]-=z*(M[2]-x)/L|0}catch{}}if(m>E){M=A[m--];try{M[0]-=z*(M[0]-U)/L|0,M[1]-=z*(M[1]-h)/L|0,M[2]-=z*(M[2]-x)/L|0}catch{}}}}function Ee(u,g,U,h,x){var d=A[g],m=u/G;d[0]-=m*(d[0]-U)|0,d[1]-=m*(d[1]-h)|0,d[2]-=m*(d[2]-x)|0}function We(u,g,U){var h,x,d,m,E,T,z,ee,M,J;for(ee=~(1<<31),M=ee,T=-1,z=T,h=0;h<t;h++)J=A[h],x=J[0]-u,x<0&&(x=-x),d=J[1]-g,d<0&&(d=-d),x+=d,d=J[2]-U,d<0&&(d=-d),x+=d,x<ee&&(ee=x,T=h),m=x-(se[h]>>v-o),m<M&&(M=m,z=h),E=ae[h]>>p,ae[h]-=E,se[h]+=E<<S;return ae[T]+=f,se[T]-=w,z}Me.apply(this,arguments);var le={};return le.map=ye,le.process=Oe,le}function we(){var t=this;try{t.onmessage=function(a){var i=a.data||{},r;i.gifshot&&(r=e.run(i),postMessage(r))}}catch{}var e={dataToRGB:function(i,r,l){for(var s=r*l*4,o=0,c=[];o<s;)c.push(i[o++]),c.push(i[o++]),c.push(i[o++]),o++;return c},componentizedPaletteToArray:function(i){i=i||[];for(var r=[],l=0;l<i.length;l+=3){var s=i[l],o=i[l+1],c=i[l+2];r.push(s<<16|o<<8|c)}return r},processFrameWithQuantizer:function(i,r,l,s){for(var o=this.dataToRGB(i,r,l),c=new Se(o,o.length,s),v=c.process(),b=new Uint32Array(this.componentizedPaletteToArray(v)),S=r*l,p=new Uint8Array(S),f=0,w=0;w<S;w++){var F=o[f++],k=o[f++],_=o[f++];p[w]=c.map(F,k,_)}return{pixels:p,palette:b}},run:function(i){i=i||{};var r=i,l=r.height;r.palette;var s=r.sampleInterval,o=r.width,c=i.data;return this.processFrameWithQuantizer(c,o,l,s)}};return e}function C(t,e,a,i){var r=0;i=i===I?{}:i;var l=i.loop===I?null:i.loop,s=i.palette===I?null:i.palette;if(e<=0||a<=0||e>65535||a>65535)throw"Width/Height invalid.";function o(p){var f=p.length;if(f<2||f>256||f&f-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return f}t[r++]=71,t[r++]=73,t[r++]=70,t[r++]=56,t[r++]=57,t[r++]=97;var c=0,v=0;if(t[r++]=e&255,t[r++]=e>>8&255,t[r++]=a&255,t[r++]=a>>8&255,t[r++]=(s!==null?128:0)|c,t[r++]=v,t[r++]=0,l!==null){if(l<0||l>65535)throw"Loop count invalid.";t[r++]=33,t[r++]=255,t[r++]=11,t[r++]=78,t[r++]=69,t[r++]=84,t[r++]=83,t[r++]=67,t[r++]=65,t[r++]=80,t[r++]=69,t[r++]=50,t[r++]=46,t[r++]=48,t[r++]=3,t[r++]=1,t[r++]=l&255,t[r++]=l>>8&255,t[r++]=0}var b=!1;this.addFrame=function(p,f,w,F,k,_){if(b===!0&&(--r,b=!1),_=_===I?{}:_,p<0||f<0||p>65535||f>65535)throw"x/y invalid.";if(w<=0||F<=0||w>65535||F>65535)throw"Width/Height invalid.";if(k.length<w*F)throw"Not enough pixels for the frame size.";var P=!0,O=_.palette;if((O===I||O===null)&&(P=!1,O=s),O===I||O===null)throw"Must supply either a local or global palette.";for(var V=o(O),G=0;V>>=1;)++G;V=1<<G;var B=_.delay===I?0:_.delay,Y=_.disposal===I?0:_.disposal;if(Y<0||Y>3)throw"Disposal out of range.";var Q=!1,D=0;if(_.transparent!==I&&_.transparent!==null&&(Q=!0,D=_.transparent,D<0||D>=V))throw"Transparent color index.";if((Y!==0||Q||B!==0)&&(t[r++]=33,t[r++]=249,t[r++]=4,t[r++]=Y<<2|(Q===!0?1:0),t[r++]=B&255,t[r++]=B>>8&255,t[r++]=D,t[r++]=0),t[r++]=44,t[r++]=p&255,t[r++]=p>>8&255,t[r++]=f&255,t[r++]=f>>8&255,t[r++]=w&255,t[r++]=w>>8&255,t[r++]=F&255,t[r++]=F>>8&255,t[r++]=P===!0?128|G-1:0,P===!0)for(var L=0,re=O.length;L<re;++L){var H=O[L];t[r++]=H>>16&255,t[r++]=H>>8&255,t[r++]=H&255}r=S(t,r,G<2?2:G,k)},this.end=function(){return b===!1&&(t[r++]=59,b=!0),r};function S(p,f,w,F){p[f++]=w;var k=f++,_=1<<w,P=_-1,O=_+1,V=O+1,G=w+1,B=0,Y=0;function Q(ae){for(;B>=ae;)p[f++]=Y&255,Y>>=8,B-=8,f===k+256&&(p[k]=255,k=f++)}function D(ae){Y|=ae<<B,B+=G,Q(8)}var L=F[0]&P,re={};D(_);for(var H=1,Z=F.length;H<Z;++H){var A=F[H]&P,$=L<<8|A,se=re[$];if(se===I){for(Y|=L<<B,B+=G;B>=8;)p[f++]=Y&255,Y>>=8,B-=8,f===k+256&&(p[k]=255,k=f++);V===4096?(D(_),V=O+1,G=w+1,re={}):(V>=1<<G&&++G,re[$]=V++),L=A}else L=se}return D(L),D(O),Q(1),k+1===f?p[k]=0:(p[k]=f-k-1,p[f++]=0),f}}var y=function(){},W=function(e){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=y,this.onRenderProgressCallback=y,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=e,this.initializeWebWorkers(e)};W.prototype={workerMethods:we(),initializeWebWorkers:function(e){var a=this,i=Se.toString()+"("+we.toString()+"());",r=void 0,l=void 0,s=void 0,o=void 0,c=-1,v="";for(o=e.numWorkers;++c<o;)r=n.createWebWorker(i),n.isObject(r)?(l=r.objectUrl,s=r.worker,a.workers.push({worker:s,objectUrl:l}),a.availableWorkers.push(s)):(v=r,n.webWorkerError=!!r);this.workerError=v,this.canvas=X.createElement("canvas"),this.canvas.width=e.gifWidth,this.canvas.height=e.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var t=[],e=0;e<256;e++)t[e]=String.fromCharCode(e);return t}(),bufferToString:function(e){for(var a=e.length,i="",r=-1;++r<a;)i+=this.byteMap[e[r]];return i},onFrameFinished:function(e){var a=this,i=a.frames,r=a.options,l=!!(r.images||[]).length,s=i.every(function(o){return!o.beingProcessed&&o.done});a.numRenderedFrames++,l&&e(a.numRenderedFrames/i.length),a.onRenderProgressCallback(a.numRenderedFrames*.75/i.length),s?a.generatingGIF||a.generateGIF(i,a.onRenderCompleteCallback):n.requestTimeout(function(){a.processNextFrame()},1)},processFrame:function(e){var a=this;this.options;var i=this.options,r=i.progressCallback,l=i.sampleInterval,s=this.frames,o=void 0,c=void 0,v=function(){var S=arguments.length>0&&arguments[0]!==I?arguments[0]:{},p=S.data;delete o.data,o.pixels=Array.prototype.slice.call(p.pixels),o.palette=Array.prototype.slice.call(p.palette),o.done=!0,o.beingProcessed=!1,a.freeWorker(c),a.onFrameFinished(r)};if(o=s[e],o.beingProcessed||o.done){this.onFrameFinished();return}o.sampleInterval=l,o.beingProcessed=!0,o.gifshot=!0,c=this.getWorker(),c?(c.onmessage=v,c.postMessage(o)):v({data:a.workerMethods.run(o)})},startRendering:function(e){this.onRenderCompleteCallback=e;for(var a=0;a<this.options.numWorkers&&a<this.frames.length;a++)this.processFrame(a)},processNextFrame:function(){for(var e=-1,a=0;a<this.frames.length;a++){var i=this.frames[a];if(!i.done&&!i.beingProcessed){e=a;break}}e>=0&&this.processFrame(e)},generateGIF:function(e,a){var i=[],r={loop:this.repeat},l=this.options,s=l.interval,o=l.frameDuration,c=l.images,v=!!c.length,b=l.gifHeight,S=l.gifWidth,p=new C(i,S,b,r),f=this.onRenderProgressCallback,w=v?s*100:0,F=void 0,k=void 0;this.generatingGIF=!0,n.each(e,function(_,P){var O=P.palette;f(.75+.25*P.position*1/e.length);for(var V=0;V<o;V++)p.addFrame(0,0,S,b,P.pixels,{palette:O,delay:w})}),p.end(),f(1),this.frames=[],this.generatingGIF=!1,n.isFunction(a)&&(F=this.bufferToString(i),k="data:image/gif;base64,"+n.btoa(F),a(k))},setRepeat:function(e){this.repeat=e},addFrame:function(e,a){a=n.isObject(a)?a:{};var i=this,r=i.ctx,l=i.options,s=l.gifWidth,o=l.gifHeight,c=n.getFontSize(a),v=a,b=v.filter,S=v.fontColor,p=v.fontFamily,f=v.fontWeight;v.gifHeight,v.gifWidth;var w=v.text,F=v.textAlign,k=v.textBaseline,_=a.textXCoordinate?a.textXCoordinate:F==="left"?1:F==="right"?s:s/2,P=a.textYCoordinate?a.textYCoordinate:k==="top"?1:k==="center"?o/2:o,O=f+" "+c+" "+p,V=void 0;try{r.filter=b,r.drawImage(e,0,0,s,o),w&&(r.font=O,r.fillStyle=S,r.textAlign=F,r.textBaseline=k,r.fillText(w,_,P)),V=r.getImageData(0,0,s,o),i.addFrameImageData(V)}catch(G){return""+G}},addFrameImageData:function(){var e=arguments.length>0&&arguments[0]!==I?arguments[0]:{},a=this.frames,i=e.data;this.frames.push({data:i,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:a.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var a=this,i=function(l){a.destroyWorkers(),n.requestTimeout(function(){e(l)},0)};a.startRendering(i)},destroyWorkers:function(){if(!this.workerError){var e=this.workers;n.each(e,function(a,i){var r=i.worker,l=i.objectUrl;r.terminate(),n.URL.revokeObjectURL(l)})}}};function K(t,e){t.getBase64GIF(function(a){e({error:!1,errorCode:"",errorMsg:"",image:a})})}function ze(){var t=arguments.length>0&&arguments[0]!==I?arguments[0]:{},e=t.callback,a=t.images,i=t.options,r=t.imagesLength,l={getUserMedia:!0,"window.URL":!0},s=j.validate(l),o=[],c=0,v=void 0,b=void 0;if(s.error)return e(s);b=new W(i),n.each(a,function(p,f){var w=f;f.src&&(w=w.src),n.isElement(w)?(i.crossOrigin&&(w.crossOrigin=i.crossOrigin),o[p]=w,c+=1,c===r&&S()):n.isString(w)&&(v=new Image,i.crossOrigin&&(v.crossOrigin=i.crossOrigin),function(F){f.text&&(F.text=f.text),F.onerror=function(k){var _=void 0;if(--r,r===0)return _={},_.error="None of the requested images was capable of being retrieved",e(_)},F.onload=function(k){f.text?o[p]={img:F,text:F.text}:o[p]=F,c+=1,c===r&&S(),n.removeElement(F)},F.src=w}(v),n.setCSSAttr(v,{position:"fixed",opacity:"0"}),X.body.appendChild(v))});function S(){n.each(o,function(p,f){f&&(f.text?b.addFrame(f.img,i,f.text):b.addFrame(f,i))}),K(b,e)}}var Xe=function(){},Re={getGIF:function(){var e=arguments.length>0&&arguments[0]!==I?arguments[0]:{},a=arguments[1];a=n.isFunction(a)?a:Xe;var i=X.createElement("canvas"),r=void 0,l=e.images,s=!!l.length,o=e.cameraStream,c=e.crop,v=e.filter,b=e.fontColor,S=e.fontFamily,p=e.fontWeight,f=e.keepCameraOn;e.numWorkers;var w=e.progressCallback,F=e.saveRenderingContexts,k=e.savedRenderingContexts,_=e.text,P=e.textAlign,O=e.textBaseline,V=e.videoElement,G=e.videoHeight,B=e.videoWidth,Y=e.webcamVideoElement,Q=Number(e.gifWidth),D=Number(e.gifHeight),L=Number(e.interval);Number(e.sampleInterval);var re=s?0:L*1e3,H=[],Z=k.length?k.length:e.numFrames,A=Z,$=new W(e),se=n.getFontSize(e),ae=e.textXCoordinate?e.textXCoordinate:P==="left"?1:P==="right"?Q:Q/2,he=e.textYCoordinate?e.textYCoordinate:O==="top"?1:O==="center"?D/2:D,Me=p+" "+se+" "+S,pe=c?Math.floor(c.scaledWidth/2):0,xe=c?B-c.scaledWidth:0,be=c?Math.floor(c.scaledHeight/2):0,ye=c?G-c.scaledHeight:0,Oe=function Ce(){var Fe=A-1;k.length?(r.putImageData(k[Z-A],0,0),We()):Ee();function Ee(){try{xe>B&&(xe=B),ye>G&&(ye=G),pe<0&&(pe=0),be<0&&(be=0),r.filter=v,r.drawImage(V,pe,be,xe,ye,0,0,Q,D),We()}catch(le){if(le.name==="NS_ERROR_NOT_AVAILABLE")n.requestTimeout(Ee,100);else throw le}}function We(){var le=void 0;F&&H.push(r.getImageData(0,0,Q,D)),_&&(r.font=Me,r.fillStyle=b,r.textAlign=P,r.textBaseline=O,r.fillText(_,ae,he)),le=r.getImageData(0,0,Q,D),$.addFrameImageData(le),A=Fe,w((Z-A)/Z),Fe>0&&n.requestTimeout(Ce,re),A||$.getBase64GIF(function(u){a({error:!1,errorCode:"",errorMsg:"",image:u,cameraStream:o,videoElement:V,webcamVideoElement:Y,savedRenderingContexts:H,keepCameraOn:f})})}};Z=Z!==I?Z:10,L=L!==I?L:.1,i.width=Q,i.height=D,r=i.getContext("2d"),function Ce(){if(!k.length&&V.currentTime===0){n.requestTimeout(Ce,100);return}Oe()}()},getCropDimensions:function(){var e=arguments.length>0&&arguments[0]!==I?arguments[0]:{},a=e.videoWidth,i=e.videoHeight,r=e.gifWidth,l=e.gifHeight,s={width:0,height:0,scaledWidth:0,scaledHeight:0};return a>i?(s.width=Math.round(a*(l/i))-r,s.scaledWidth=Math.round(s.width*(i/l))):(s.height=Math.round(i*(r/a))-l,s.scaledHeight=Math.round(s.height*(a/r))),s}},N={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function t(e){t.attempts=t.attempts||0;var a=e.cameraStream,i=e.completedCallback,r=e.videoElement;r&&(r.videoWidth>0&&r.videoHeight>0?(r.removeEventListener("loadeddata",N.findVideoSize),i({videoElement:r,cameraStream:a,videoWidth:r.videoWidth,videoHeight:r.videoHeight})):t.attempts<10?(t.attempts+=1,n.requestTimeout(function(){N.findVideoSize(e)},400)):i({videoElement:r,cameraStream:a,videoWidth:N.defaultVideoDimensions.width,videoHeight:N.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){n.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var a=n.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,i=e.cameraStream,r=e.completedCallback,l=e.streamedCallback,s=e.videoElement;if(n.isFunction(l)&&l(),a){if(n.isString(a))s.src=a,s.innerHTML='<source src="'+a+'" type="video/'+n.getExtension(a)+'" />';else if(a instanceof Blob){try{s.src=n.URL.createObjectURL(a)}catch{}s.innerHTML='<source src="'+a+'" type="'+a.type+'" />'}}else if(s.mozSrcObject)s.mozSrcObject=i;else if(n.URL)try{s.srcObject=i,s.src=n.URL.createObjectURL(i)}catch{s.srcObject=i}s.play(),n.requestTimeout(function o(){o.count=o.count||0,N.loadedData===!0?(N.findVideoSize({videoElement:s,cameraStream:i,completedCallback:r}),N.loadedData=!1):(o.count+=1,o.count>10?N.findVideoSize({videoElement:s,cameraStream:i,completedCallback:r}):o())},0)},startStreaming:function(e){var a=n.isFunction(e.error)?e.error:n.noop,i=n.isFunction(e.streamed)?e.streamed:n.noop,r=n.isFunction(e.completed)?e.completed:n.noop,l=e.crossOrigin,s=e.existingVideo,o=e.lastCameraStream,c=e.options,v=e.webcamVideoElement,b=n.isElement(s)?s:v||X.createElement("video");l&&(b.crossOrigin=c.crossOrigin),b.autoplay=!0,b.loop=!0,b.muted=!0,b.addEventListener("loadeddata",function(S){N.loadedData=!0,c.offset&&(b.currentTime=c.offset)}),s?N.stream({videoElement:b,existingVideo:s,completedCallback:r}):o?N.stream({videoElement:b,cameraStream:o,streamedCallback:i,completedCallback:r}):n.getUserMedia({video:!0},function(S){N.stream({videoElement:b,cameraStream:S,streamedCallback:i,completedCallback:r})},a)},startVideoStreaming:function(e){var a=arguments.length>1&&arguments[1]!==I?arguments[1]:{},i=a.timeout!==I?a.timeout:0,r=a.callback,l=a.webcamVideoElement,s=void 0;i>0&&(s=n.requestTimeout(function(){N.onStreamingTimeout(r)},1e4)),N.startStreaming({error:function(){r({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(s)},completed:function(){var c=arguments.length>0&&arguments[0]!==I?arguments[0]:{},v=c.cameraStream,b=c.videoElement,S=c.videoHeight,p=c.videoWidth;e({cameraStream:v,videoElement:b,videoHeight:S,videoWidth:p})},lastCameraStream:a.lastCameraStream,webcamVideoElement:l,crossOrigin:a.crossOrigin,options:a})},stopVideoStreaming:function(e){e=n.isObject(e)?e:{};var a=e,i=a.keepCameraOn,r=a.videoElement,l=a.webcamVideoElement,s=e.cameraStream||{},o=s.getTracks?s.getTracks()||[]:[],c=!!o.length,v=o[0];!i&&c&&n.isFunction(v.stop)&&v.stop(),n.isElement(r)&&!l&&(r.pause(),n.isFunction(n.URL.revokeObjectURL)&&!n.webWorkerError&&r.src&&n.URL.revokeObjectURL(r.src),n.removeElement(r))}};function Ge(t){t=n.isObject(t)?t:{},N.stopVideoStreaming(t)}function He(t,e){var a=t.options||{},i=a.images,r=a.video,l=Number(a.gifWidth),s=Number(a.gifHeight);Number(a.numFrames);var o=t.cameraStream,c=t.videoElement,v=t.videoWidth,b=t.videoHeight,S=Re.getCropDimensions({videoWidth:v,videoHeight:b,gifHeight:s,gifWidth:l}),p=e;a.crop=S,a.videoElement=c,a.videoWidth=v,a.videoHeight=b,a.cameraStream=o,n.isElement(c)&&(c.width=l+S.width,c.height=s+S.height,a.webcamVideoElement||(n.setCSSAttr(c,{position:"fixed",opacity:"0"}),X.body.appendChild(c)),c.play(),Re.getGIF(a,function(f){(!i||!i.length)&&(!r||!r.length)&&Ge(f),p(f)}))}function Ye(){var t=arguments.length>0&&arguments[0]!==I?arguments[0]:{},e=t.callback,a=t.existingVideo,i=t.options,r={getUserMedia:!0,"window.URL":!0},l=j.validate(r),s=void 0,o=void 0;if(l.error)return e(l);if(n.isElement(a)&&a.src){if(o=a.src,s=n.getExtension(o),!n.isSupported.videoCodecs[s])return e(j.messages.videoCodecs)}else n.isArray(a)&&n.each(a,function(c,v){if(v instanceof Blob?s=v.type.substr(v.type.lastIndexOf("/")+1,v.length):s=v.substr(v.lastIndexOf(".")+1,v.length),n.isSupported.videoCodecs[s])return a=v,!1});N.startStreaming({completed:function(v){v.options=i||{},He(v,e)},existingVideo:a,crossOrigin:i.crossOrigin,options:i})}function Qe(){var t=arguments.length>0&&arguments[0]!==I?arguments[0]:{},e=t.callback,a=t.lastCameraStream,i=t.options,r=t.webcamVideoElement;if(!ge())return e(j.validate());if(i.savedRenderingContexts.length){Re.getGIF(i,function(l){e(l)});return}N.startVideoStreaming(function(){var l=arguments.length>0&&arguments[0]!==I?arguments[0]:{};l.options=i||{},He(l,e)},{lastCameraStream:a,callback:e,webcamVideoElement:r,crossOrigin:i.crossOrigin})}function Be(t,e){if(e=n.isFunction(t)?t:e,t=n.isObject(t)?t:{},!!n.isFunction(e)){var a=n.mergeOptions(ue,t)||{},i=t.cameraStream,r=a.images,l=r?r.length:0,s=a.video,o=a.webcamVideoElement;a=n.mergeOptions(a,{gifWidth:Math.floor(a.gifWidth),gifHeight:Math.floor(a.gifHeight)}),l?ze({images:r,imagesLength:l,callback:e,options:a}):s?Ye({existingVideo:s,callback:e,options:a}):Qe({lastCameraStream:i,callback:e,webcamVideoElement:o,options:a})}}function Ke(t,e){if(e=n.isFunction(t)?t:e,t=n.isObject(t)?t:{},!!n.isFunction(e)){var a=n.mergeOptions(ue,t),i=n.mergeOptions(a,{interval:.1,numFrames:1,gifWidth:Math.floor(a.gifWidth),gifHeight:Math.floor(a.gifHeight)});Be(i,e)}}var Pe={utils:de,error:oe,defaultOptions:Ie,createGIF:Be,takeSnapShot:Ke,stopVideoStreaming:Ge,isSupported:Ae,isWebCamGIFSupported:ge,isExistingVideoGIFSupported:Ue,isExistingImagesGIFSupported:Te,VERSION:"0.4.5"};typeof I=="function"&&I.amd?I([],function(){return Pe}):me.exports=Pe})(typeof window<"u"?window:{},typeof document<"u"?document:{createElement:function(){}},typeof window<"u"?window.navigator:{})})(qe);var dt=qe.exports;const Le=me=>(at("data-v-29b9bea8"),me=me(),it(),me),vt=Le(()=>q("h1",null,'"今天单推谁"GIF生成器',-1)),mt={id:"input-container"},ft={id:"modes-settings"},ut=Le(()=>q("span",{id:"matching-hint"},"类型选择: ",-1)),gt=["for"],ht=["checked","value","id","onChange"],pt=["onClick"],xt={id:"modes-settings"},bt=Le(()=>q("span",{id:"matching-hint"},"快捷选项: ",-1)),yt=["for"],Ct=["onUpdate:modelValue","id"],kt={id:"image-container"},St={key:0,style:{"text-align":"center"}},wt="bold 50px KaiTi",je="images/",Ne="white",Ft="black",Et="今天单推谁？",Wt={__name:"GIFMemeEditor",setup(me){const te=ve(null),R=ve([]),X=ve(!1),ce=ve(!0);ve(!1);const I=new nt("KaiTi"),n=ve(lt),de=ve(ct),j=ve([{name:"角色",mark:ce}]);let oe,fe;async function ue(){ce.value?fe=je+"character_icons/":fe=je+"seiyuu_icons/",ot(oe,Ft,wt,!1,210,75,Et),document.getElementById("image-container").getElementsByTagName("img").length>0&&document.getElementById("image-container").removeChild(document.getElementById("image-container").getElementsByTagName("img")[0]),R.value=[],X.value=!0;for(let C=0;C<n.value.length;C++)if(n.value[C].checked){const y=n.value[C],W=await st(fe+y.Eng+".png");oe.drawImage(W,48,130,300,300);const K=te.value.toDataURL("image/png");R.value.push(K),oe.fillStyle=Ne,oe.fillRect(48,130,te.value.width,te.value.height)}Ie()}const Ie=()=>{dt.createGIF({images:R.value,gifWidth:te.value.width,gifHeight:te.value.height},function(C){if(!C.error){var y=C.image,W=document.createElement("img");W.src=y,X.value=!1,document.getElementById("image-container").appendChild(W)}})};function Ae(){const C=document.getElementById("image-container").getElementsByTagName("img")[0].src,y=document.createElement("a");y.href=C,y.download="今天单推谁.gif",y.click()}Je(async()=>{try{await Promise.all([I.check()]),oe=te.value.getContext("2d"),oe.fillStyle=Ne,oe.fillRect(0,0,te.value.width,te.value.height)}catch(C){console.error(C)}});const ge=()=>{for(let C=0;C<n.value.length;C++)n.value[C].checked=!1;for(let C=0;C<de.value.length;C++)de.value[C].checked=!1},Te=C=>{for(let y=0;y<n.value.length;y++)n.value[y].checked=!1;for(let y=0;y<C.length;y++)if(C[y].checked)for(let W=0;W<C[y].char.length;W++){const K=C[y].char[W];n.value[K].checked=!0}},Ue=C=>{for(let y=0;y<j.value.length;y++)j.value[y].name!=C.name?j.value[y].mark=!1:j.value[y].mark=!0;ge()},Se=()=>{const C=[];for(let y=0;y<n.value.length;y+=7)C.push(n.value.slice(y,y+7));return C},we=C=>{for(let y=0;y<de.value.length;y++)de.value[y].checked=!1;C.checked=!C.checked};return(C,y)=>(ie(),ne(ke,null,[vt,q("div",mt,[q("div",ft,[ut,(ie(!0),ne(ke,null,_e(j.value,W=>(ie(),ne("div",{key:W.name},[q("label",{for:W.name},Ve(W.name),9,gt),q("input",{type:"radio",name:"check",checked:W.mark,value:W.mark,id:W.name,onChange:K=>Ue(W)},null,40,ht)]))),128))]),q("table",null,[(ie(!0),ne(ke,null,_e(Se(),W=>(ie(),ne("tr",{key:W[0].label},[(ie(!0),ne(ke,null,_e(W,K=>(ie(),ne("td",{key:K.label,class:$e({character_selected:K.checked}),onClick:ze=>we(K)},Ve(K.label),11,pt))),128))]))),128))]),q("div",xt,[bt,(ie(!0),ne(ke,null,_e(de.value,W=>(ie(),ne("div",{key:W.label},[q("label",{for:W.label},Ve(W.label),9,yt),et(q("input",{"onUpdate:modelValue":K=>W.checked=K,type:"checkbox",id:W.label,onChange:y[0]||(y[0]=K=>Te(de.value))},null,40,Ct),[[tt,W.checked]])]))),128))]),q("div",{id:"button-container"},[q("button",{onClick:ue,class:"btns",style:{"background-color":"cornflowerblue"}},"绘制GIF图"),q("button",{onClick:ge,class:"btns",style:{"background-color":"gray"}},"清空选择"),q("button",{onClick:Ae,class:"btns"},"下载GIF图")])]),q("div",kt,[q("canvas",{id:"GIF-canvas",ref_key:"canvas",ref:te,width:"400",height:"500",style:{display:"none"}},null,512),X.value?(ie(),ne("span",St,"生成中······")):rt("",!0)])],64))}},Ut=Ze(Wt,[["__scopeId","data-v-29b9bea8"]]);export{Ut as default};
