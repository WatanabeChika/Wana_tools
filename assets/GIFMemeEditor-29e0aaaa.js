import{_ as Je,r as ce,o as $e,a as de,c as ve,b as P,F as Me,d as Ve,t as Oe,n as et,e as tt,v as rt,i as Be,p as at,g as it}from"./index-68a7fc2c.js";import{F as nt,f as ot,l as st}from"./utils-0b72f588.js";import{c as lt,L as ct}from"./data-ca991437.js";import"./_commonjsHelpers-de833af9.js";var qe={exports:{}};(function(ue,re){(function(U,q,J,E){var n={URL:U.URL||U.webkitURL||U.mozURL||U.msURL,getUserMedia:function(){var t=J.getUserMedia||J.webkitGetUserMedia||J.mozGetUserMedia||J.msGetUserMedia;return t&&t.bind(J)}(),requestAnimFrame:U.requestAnimationFrame||U.webkitRequestAnimationFrame||U.mozRequestAnimationFrame||U.oRequestAnimationFrame||U.msRequestAnimationFrame,requestTimeout:function(e,a){if(e=e||n.noop,a=a||0,!n.requestAnimFrame)return setTimeout(e,a);var i=new Date().getTime(),r=new Object,l=n.requestAnimFrame,s=function o(){var c=new Date().getTime(),v=c-i;v>=a?e.call():r.value=l(o)};return r.value=l(s),r},Blob:U.Blob||U.BlobBuilder||U.WebKitBlobBuilder||U.MozBlobBuilder||U.MSBlobBuilder,btoa:function(){var t=U.btoa||function(e){for(var a="",i=0,r=e.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=void 0,o=void 0,c=void 0,v=void 0,b=void 0,y=void 0,p=void 0;i<r;)s=e.charCodeAt(i++),o=e.charCodeAt(i++),c=e.charCodeAt(i++),v=s>>2,b=(s&3)<<4|o>>4,y=(o&15)<<2|c>>6,p=c&63,isNaN(o)?y=p=64:isNaN(c)&&(p=64),a=a+l.charAt(v)+l.charAt(b)+l.charAt(y)+l.charAt(p);return a};return t?t.bind(U):n.noop}(),isObject:function(e){return e&&Object.prototype.toString.call(e)==="[object Object]"},isEmptyObject:function(e){return n.isObject(e)&&!Object.keys(e).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&typeof e=="function"},isElement:function(e){return e&&e.nodeType===1},isString:function(e){return typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"},isSupported:{canvas:function(){var e=q.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return U.Worker},blob:function(){return n.Blob},Uint8Array:function(){return U.Uint8Array},Uint32Array:function(){return U.Uint32Array},videoCodecs:function(){var t=q.createElement("video"),e={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{t&&t.canPlayType&&(e.mp4=t.canPlayType('video/mp4; codecs="mp4v.20.8"')!=="",e.h264=(t.canPlayType('video/mp4; codecs="avc1.42E01E"')||t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'))!=="",e.ogv=t.canPlayType('video/ogg; codecs="theora"')!=="",e.ogg=t.canPlayType('video/ogg; codecs="theora"')!=="",e.webm=t.canPlayType('video/webm; codecs="vp8, vorbis"')!==-1)}catch{}return e}()},noop:function(){},each:function(e,a){var i=void 0,r=void 0;if(n.isArray(e))for(i=-1,r=e.length;++i<r&&a(i,e[i])!==!1;);else if(n.isObject(e)){for(i in e)if(e.hasOwnProperty(i)&&a(i,e[i])===!1)break}},mergeOptions:function(e,a){if(!(!n.isObject(e)||!n.isObject(a)||!Object.keys)){var i={};return n.each(e,function(r,l){i[r]=e[r]}),n.each(a,function(r,l){var s=a[r];n.isObject(s)&&e[r]?i[r]=n.mergeOptions(e[r],s):i[r]=s}),i}},setCSSAttr:function(e,a,i){n.isElement(e)&&(n.isString(a)&&n.isString(i)?e.style[a]=i:n.isObject(a)&&n.each(a,function(r,l){e.style[r]=l}))},removeElement:function(e){n.isElement(e)&&e.parentNode&&e.parentNode.removeChild(e)},createWebWorker:function(e){if(!n.isString(e))return{};try{var a=new n.Blob([e],{type:"text/javascript"}),i=n.URL.createObjectURL(a),r=new Worker(i);return{objectUrl:i,worker:r}}catch(l){return""+l}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(){var e=arguments.length>0&&arguments[0]!==E?arguments[0]:{};if(!q.body||e.resizeFont===!1)return e.fontSize;var a=e.text,i=e.gifWidth,r=parseInt(e.fontSize,10),l=parseInt(e.minFontSize,10),s=q.createElement("div"),o=q.createElement("span");for(s.setAttribute("width",i),s.appendChild(o),o.innerHTML=a,o.style.fontSize=r+"px",o.style.textIndent="-9999px",o.style.visibility="hidden",q.body.appendChild(o);o.offsetWidth>i&&r>=l;)o.style.fontSize=--r+"px";return q.body.removeChild(o),r+"px"},webWorkerError:!1},$=Object.freeze({default:n}),B={validate:function(e){e=n.isObject(e)?e:{};var a={};return n.each(B.validators,function(i,r){var l=r.errorCode;if(!e[l]&&!r.condition)return a=r,a.error=!0,!1}),delete a.condition,a},isValid:function(e){var a=B.validate(e),i=a.error!==!0;return i},validators:[{condition:n.isFunction(n.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:n.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:n.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:n.isFunction(n.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:n.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:n.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:n.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},fe=Object.freeze({default:B}),ae=function(){},me={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:ae,completeCallback:ae,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},_e=Object.freeze({default:me});function Ie(){return B.isValid()}function ke(){return B.isValid()}function ye(){var t={getUserMedia:!0};return B.isValid(t)}function Ae(t){var e=!1;if(n.isArray(t)&&t.length){if(n.each(t,function(a,i){n.isSupported.videoCodecs[i]&&(e=!0)}),!e)return!1}else if(n.isString(t)&&t.length&&!n.isSupported.videoCodecs[t])return!1;return B.isValid({getUserMedia:!0})}function Se(){var t=256,e=499,a=491,i=487,r=503,l=3*r,s=t-1,o=4,c=100,v=16,b=1<<v,y=10,p=10,m=b>>p,S=b<<y-p,w=t>>3,k=6,W=1<<k,j=w*W,V=30,O=10,z=1<<O,D,Y=8,Q=1<<Y,N=O+Y,L=1<<N,ne,H,K,I,ee=[],se=[],oe=[],ge=[];function Re(u,g,R){var h,x;for(ne=u,H=g,K=R,I=new Array(t),h=0;h<t;h++)I[h]=new Array(4),x=I[h],x[0]=x[1]=x[2]=(h<<o+8)/t|0,oe[h]=b/t|0,se[h]=0}function he(){for(var u=[],g=new Array(t),R=0;R<t;R++)g[I[R][3]]=R;for(var h=0,x=0;x<t;x++){var d=g[x];u[h++]=I[d][0],u[h++]=I[d][1],u[h++]=I[d][2]}return u}function pe(){var u,g,R,h,x,d,f,F;for(f=0,F=0,u=0;u<t;u++){for(x=I[u],R=u,h=x[1],g=u+1;g<t;g++)d=I[g],d[1]<h&&(R=g,h=d[1]);if(d=I[R],u!=R&&(g=d[0],d[0]=x[0],x[0]=g,g=d[1],d[1]=x[1],x[1]=g,g=d[2],d[2]=x[2],x[2]=g,g=d[3],d[3]=x[3],x[3]=g),h!=f){for(ee[f]=F+u>>1,g=f+1;g<h;g++)ee[g]=u;f=h,F=u}}for(ee[f]=F+s>>1,g=f+1;g<256;g++)ee[g]=s}function xe(){var u,g,R,h,x,d,f,F,A,G,te,M,Z,De;for(H<l&&(K=1),D=30+(K-1)/3,M=ne,Z=0,De=H,te=H/(3*K),G=te/c|0,F=z,d=j,f=d>>k,f<=1&&(f=0),u=0;u<f;u++)ge[u]=F*((f*f-u*u)*Q/(f*f));for(H<l?A=3:H%e!==0?A=3*e:H%a!==0?A=3*a:H%i!==0?A=3*i:A=3*r,u=0;u<te;)if(R=(M[Z+0]&255)<<o,h=(M[Z+1]&255)<<o,x=(M[Z+2]&255)<<o,g=We(R,h,x),Ee(F,g,R,h,x),f!==0&&Fe(f,g,R,h,x),Z+=A,Z>=De&&(Z-=H),u++,G===0&&(G=1),u%G===0)for(F-=F/D,d-=d/V,f=d>>k,f<=1&&(f=0),g=0;g<f;g++)ge[g]=F*((f*f-g*g)*Q/(f*f))}function be(u,g,R){var h,x,d,f,F,A,G;for(F=1e3,G=-1,h=ee[g],x=h-1;h<t||x>=0;)h<t&&(A=I[h],d=A[1]-g,d>=F?h=t:(h++,d<0&&(d=-d),f=A[0]-u,f<0&&(f=-f),d+=f,d<F&&(f=A[2]-R,f<0&&(f=-f),d+=f,d<F&&(F=d,G=A[3])))),x>=0&&(A=I[x],d=g-A[1],d>=F?x=-1:(x--,d<0&&(d=-d),f=A[0]-u,f<0&&(f=-f),d+=f,d<F&&(f=A[2]-R,f<0&&(f=-f),d+=f,d<F&&(F=d,G=A[3]))));return G}function Ue(){return xe(),Ce(),pe(),he()}function Ce(){var u;for(u=0;u<t;u++)I[u][0]>>=o,I[u][1]>>=o,I[u][2]>>=o,I[u][3]=u}function Fe(u,g,R,h,x){var d,f,F,A,G,te,M;for(F=g-u,F<-1&&(F=-1),A=g+u,A>t&&(A=t),d=g+1,f=g-1,te=1;d<A||f>F;){if(G=ge[te++],d<A){M=I[d++];try{M[0]-=G*(M[0]-R)/L|0,M[1]-=G*(M[1]-h)/L|0,M[2]-=G*(M[2]-x)/L|0}catch{}}if(f>F){M=I[f--];try{M[0]-=G*(M[0]-R)/L|0,M[1]-=G*(M[1]-h)/L|0,M[2]-=G*(M[2]-x)/L|0}catch{}}}}function Ee(u,g,R,h,x){var d=I[g],f=u/z;d[0]-=f*(d[0]-R)|0,d[1]-=f*(d[1]-h)|0,d[2]-=f*(d[2]-x)|0}function We(u,g,R){var h,x,d,f,F,A,G,te,M,Z;for(te=~(1<<31),M=te,A=-1,G=A,h=0;h<t;h++)Z=I[h],x=Z[0]-u,x<0&&(x=-x),d=Z[1]-g,d<0&&(d=-d),x+=d,d=Z[2]-R,d<0&&(d=-d),x+=d,x<te&&(te=x,A=h),f=x-(se[h]>>v-o),f<M&&(M=f,G=h),F=oe[h]>>p,oe[h]-=F,se[h]+=F<<y;return oe[A]+=m,se[A]-=S,G}Re.apply(this,arguments);var le={};return le.map=be,le.process=Ue,le}function we(){var t=this;try{t.onmessage=function(a){var i=a.data||{},r;i.gifshot&&(r=e.run(i),postMessage(r))}}catch{}var e={dataToRGB:function(i,r,l){for(var s=r*l*4,o=0,c=[];o<s;)c.push(i[o++]),c.push(i[o++]),c.push(i[o++]),o++;return c},componentizedPaletteToArray:function(i){i=i||[];for(var r=[],l=0;l<i.length;l+=3){var s=i[l],o=i[l+1],c=i[l+2];r.push(s<<16|o<<8|c)}return r},processFrameWithQuantizer:function(i,r,l,s){for(var o=this.dataToRGB(i,r,l),c=new Se(o,o.length,s),v=c.process(),b=new Uint32Array(this.componentizedPaletteToArray(v)),y=r*l,p=new Uint8Array(y),m=0,S=0;S<y;S++){var w=o[m++],k=o[m++],W=o[m++];p[S]=c.map(w,k,W)}return{pixels:p,palette:b}},run:function(i){i=i||{};var r=i,l=r.height;r.palette;var s=r.sampleInterval,o=r.width,c=i.data;return this.processFrameWithQuantizer(c,o,l,s)}};return e}function C(t,e,a,i){var r=0;i=i===E?{}:i;var l=i.loop===E?null:i.loop,s=i.palette===E?null:i.palette;if(e<=0||a<=0||e>65535||a>65535)throw"Width/Height invalid.";function o(p){var m=p.length;if(m<2||m>256||m&m-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return m}t[r++]=71,t[r++]=73,t[r++]=70,t[r++]=56,t[r++]=57,t[r++]=97;var c=0,v=0;if(t[r++]=e&255,t[r++]=e>>8&255,t[r++]=a&255,t[r++]=a>>8&255,t[r++]=(s!==null?128:0)|c,t[r++]=v,t[r++]=0,l!==null){if(l<0||l>65535)throw"Loop count invalid.";t[r++]=33,t[r++]=255,t[r++]=11,t[r++]=78,t[r++]=69,t[r++]=84,t[r++]=83,t[r++]=67,t[r++]=65,t[r++]=80,t[r++]=69,t[r++]=50,t[r++]=46,t[r++]=48,t[r++]=3,t[r++]=1,t[r++]=l&255,t[r++]=l>>8&255,t[r++]=0}var b=!1;this.addFrame=function(p,m,S,w,k,W){if(b===!0&&(--r,b=!1),W=W===E?{}:W,p<0||m<0||p>65535||m>65535)throw"x/y invalid.";if(S<=0||w<=0||S>65535||w>65535)throw"Width/Height invalid.";if(k.length<S*w)throw"Not enough pixels for the frame size.";var j=!0,V=W.palette;if((V===E||V===null)&&(j=!1,V=s),V===E||V===null)throw"Must supply either a local or global palette.";for(var O=o(V),z=0;O>>=1;)++z;O=1<<z;var D=W.delay===E?0:W.delay,Y=W.disposal===E?0:W.disposal;if(Y<0||Y>3)throw"Disposal out of range.";var Q=!1,N=0;if(W.transparent!==E&&W.transparent!==null&&(Q=!0,N=W.transparent,N<0||N>=O))throw"Transparent color index.";if((Y!==0||Q||D!==0)&&(t[r++]=33,t[r++]=249,t[r++]=4,t[r++]=Y<<2|(Q===!0?1:0),t[r++]=D&255,t[r++]=D>>8&255,t[r++]=N,t[r++]=0),t[r++]=44,t[r++]=p&255,t[r++]=p>>8&255,t[r++]=m&255,t[r++]=m>>8&255,t[r++]=S&255,t[r++]=S>>8&255,t[r++]=w&255,t[r++]=w>>8&255,t[r++]=j===!0?128|z-1:0,j===!0)for(var L=0,ne=V.length;L<ne;++L){var H=V[L];t[r++]=H>>16&255,t[r++]=H>>8&255,t[r++]=H&255}r=y(t,r,z<2?2:z,k)},this.end=function(){return b===!1&&(t[r++]=59,b=!0),r};function y(p,m,S,w){p[m++]=S;var k=m++,W=1<<S,j=W-1,V=W+1,O=V+1,z=S+1,D=0,Y=0;function Q(oe){for(;D>=oe;)p[m++]=Y&255,Y>>=8,D-=8,m===k+256&&(p[k]=255,k=m++)}function N(oe){Y|=oe<<D,D+=z,Q(8)}var L=w[0]&j,ne={};N(W);for(var H=1,K=w.length;H<K;++H){var I=w[H]&j,ee=L<<8|I,se=ne[ee];if(se===E){for(Y|=L<<D,D+=z;D>=8;)p[m++]=Y&255,Y>>=8,D-=8,m===k+256&&(p[k]=255,k=m++);O===4096?(N(W),O=V+1,z=S+1,ne={}):(O>=1<<z&&++z,ne[ee]=O++),L=I}else L=se}return N(L),N(V),Q(1),k+1===m?p[k]=0:(p[k]=m-k-1,p[m++]=0),m}}var T=function(){},_=function(e){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=T,this.onRenderProgressCallback=T,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=e,this.initializeWebWorkers(e)};_.prototype={workerMethods:we(),initializeWebWorkers:function(e){var a=this,i=Se.toString()+"("+we.toString()+"());",r=void 0,l=void 0,s=void 0,o=void 0,c=-1,v="";for(o=e.numWorkers;++c<o;)r=n.createWebWorker(i),n.isObject(r)?(l=r.objectUrl,s=r.worker,a.workers.push({worker:s,objectUrl:l}),a.availableWorkers.push(s)):(v=r,n.webWorkerError=!!r);this.workerError=v,this.canvas=q.createElement("canvas"),this.canvas.width=e.gifWidth,this.canvas.height=e.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var t=[],e=0;e<256;e++)t[e]=String.fromCharCode(e);return t}(),bufferToString:function(e){for(var a=e.length,i="",r=-1;++r<a;)i+=this.byteMap[e[r]];return i},onFrameFinished:function(e){var a=this,i=a.frames,r=a.options,l=!!(r.images||[]).length,s=i.every(function(o){return!o.beingProcessed&&o.done});a.numRenderedFrames++,l&&e(a.numRenderedFrames/i.length),a.onRenderProgressCallback(a.numRenderedFrames*.75/i.length),s?a.generatingGIF||a.generateGIF(i,a.onRenderCompleteCallback):n.requestTimeout(function(){a.processNextFrame()},1)},processFrame:function(e){var a=this;this.options;var i=this.options,r=i.progressCallback,l=i.sampleInterval,s=this.frames,o=void 0,c=void 0,v=function(){var y=arguments.length>0&&arguments[0]!==E?arguments[0]:{},p=y.data;delete o.data,o.pixels=Array.prototype.slice.call(p.pixels),o.palette=Array.prototype.slice.call(p.palette),o.done=!0,o.beingProcessed=!1,a.freeWorker(c),a.onFrameFinished(r)};if(o=s[e],o.beingProcessed||o.done){this.onFrameFinished();return}o.sampleInterval=l,o.beingProcessed=!0,o.gifshot=!0,c=this.getWorker(),c?(c.onmessage=v,c.postMessage(o)):v({data:a.workerMethods.run(o)})},startRendering:function(e){this.onRenderCompleteCallback=e;for(var a=0;a<this.options.numWorkers&&a<this.frames.length;a++)this.processFrame(a)},processNextFrame:function(){for(var e=-1,a=0;a<this.frames.length;a++){var i=this.frames[a];if(!i.done&&!i.beingProcessed){e=a;break}}e>=0&&this.processFrame(e)},generateGIF:function(e,a){var i=[],r={loop:this.repeat},l=this.options,s=l.interval,o=l.frameDuration,c=l.images,v=!!c.length,b=l.gifHeight,y=l.gifWidth,p=new C(i,y,b,r),m=this.onRenderProgressCallback,S=v?s*100:0,w=void 0,k=void 0;this.generatingGIF=!0,n.each(e,function(W,j){var V=j.palette;m(.75+.25*j.position*1/e.length);for(var O=0;O<o;O++)p.addFrame(0,0,y,b,j.pixels,{palette:V,delay:S})}),p.end(),m(1),this.frames=[],this.generatingGIF=!1,n.isFunction(a)&&(w=this.bufferToString(i),k="data:image/gif;base64,"+n.btoa(w),a(k))},setRepeat:function(e){this.repeat=e},addFrame:function(e,a){a=n.isObject(a)?a:{};var i=this,r=i.ctx,l=i.options,s=l.gifWidth,o=l.gifHeight,c=n.getFontSize(a),v=a,b=v.filter,y=v.fontColor,p=v.fontFamily,m=v.fontWeight;v.gifHeight,v.gifWidth;var S=v.text,w=v.textAlign,k=v.textBaseline,W=a.textXCoordinate?a.textXCoordinate:w==="left"?1:w==="right"?s:s/2,j=a.textYCoordinate?a.textYCoordinate:k==="top"?1:k==="center"?o/2:o,V=m+" "+c+" "+p,O=void 0;try{r.filter=b,r.drawImage(e,0,0,s,o),S&&(r.font=V,r.fillStyle=y,r.textAlign=w,r.textBaseline=k,r.fillText(S,W,j)),O=r.getImageData(0,0,s,o),i.addFrameImageData(O)}catch(z){return""+z}},addFrameImageData:function(){var e=arguments.length>0&&arguments[0]!==E?arguments[0]:{},a=this.frames,i=e.data;this.frames.push({data:i,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:a.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var a=this,i=function(l){a.destroyWorkers(),n.requestTimeout(function(){e(l)},0)};a.startRendering(i)},destroyWorkers:function(){if(!this.workerError){var e=this.workers;n.each(e,function(a,i){var r=i.worker,l=i.objectUrl;r.terminate(),n.URL.revokeObjectURL(l)})}}};function ie(t,e){t.getBase64GIF(function(a){e({error:!1,errorCode:"",errorMsg:"",image:a})})}function Xe(){var t=arguments.length>0&&arguments[0]!==E?arguments[0]:{},e=t.callback,a=t.images,i=t.options,r=t.imagesLength,l={getUserMedia:!0,"window.URL":!0},s=B.validate(l),o=[],c=0,v=void 0,b=void 0;if(s.error)return e(s);b=new _(i),n.each(a,function(p,m){var S=m;m.src&&(S=S.src),n.isElement(S)?(i.crossOrigin&&(S.crossOrigin=i.crossOrigin),o[p]=S,c+=1,c===r&&y()):n.isString(S)&&(v=new Image,i.crossOrigin&&(v.crossOrigin=i.crossOrigin),function(w){m.text&&(w.text=m.text),w.onerror=function(k){var W=void 0;if(--r,r===0)return W={},W.error="None of the requested images was capable of being retrieved",e(W)},w.onload=function(k){m.text?o[p]={img:w,text:w.text}:o[p]=w,c+=1,c===r&&y(),n.removeElement(w)},w.src=S}(v),n.setCSSAttr(v,{position:"fixed",opacity:"0"}),q.body.appendChild(v))});function y(){n.each(o,function(p,m){m&&(m.text?b.addFrame(m.img,i,m.text):b.addFrame(m,i))}),ie(b,e)}}var Ye=function(){},Te={getGIF:function(){var e=arguments.length>0&&arguments[0]!==E?arguments[0]:{},a=arguments[1];a=n.isFunction(a)?a:Ye;var i=q.createElement("canvas"),r=void 0,l=e.images,s=!!l.length,o=e.cameraStream,c=e.crop,v=e.filter,b=e.fontColor,y=e.fontFamily,p=e.fontWeight,m=e.keepCameraOn;e.numWorkers;var S=e.progressCallback,w=e.saveRenderingContexts,k=e.savedRenderingContexts,W=e.text,j=e.textAlign,V=e.textBaseline,O=e.videoElement,z=e.videoHeight,D=e.videoWidth,Y=e.webcamVideoElement,Q=Number(e.gifWidth),N=Number(e.gifHeight),L=Number(e.interval);Number(e.sampleInterval);var ne=s?0:L*1e3,H=[],K=k.length?k.length:e.numFrames,I=K,ee=new _(e),se=n.getFontSize(e),oe=e.textXCoordinate?e.textXCoordinate:j==="left"?1:j==="right"?Q:Q/2,ge=e.textYCoordinate?e.textYCoordinate:V==="top"?1:V==="center"?N/2:N,Re=p+" "+se+" "+y,he=c?Math.floor(c.scaledWidth/2):0,pe=c?D-c.scaledWidth:0,xe=c?Math.floor(c.scaledHeight/2):0,be=c?z-c.scaledHeight:0,Ue=function Ce(){var Fe=I-1;k.length?(r.putImageData(k[K-I],0,0),We()):Ee();function Ee(){try{pe>D&&(pe=D),be>z&&(be=z),he<0&&(he=0),xe<0&&(xe=0),r.filter=v,r.drawImage(O,he,xe,pe,be,0,0,Q,N),We()}catch(le){if(le.name==="NS_ERROR_NOT_AVAILABLE")n.requestTimeout(Ee,100);else throw le}}function We(){var le=void 0;w&&H.push(r.getImageData(0,0,Q,N)),W&&(r.font=Re,r.fillStyle=b,r.textAlign=j,r.textBaseline=V,r.fillText(W,oe,ge)),le=r.getImageData(0,0,Q,N),ee.addFrameImageData(le),I=Fe,S((K-I)/K),Fe>0&&n.requestTimeout(Ce,ne),I||ee.getBase64GIF(function(u){a({error:!1,errorCode:"",errorMsg:"",image:u,cameraStream:o,videoElement:O,webcamVideoElement:Y,savedRenderingContexts:H,keepCameraOn:m})})}};K=K!==E?K:10,L=L!==E?L:.1,i.width=Q,i.height=N,r=i.getContext("2d"),function Ce(){if(!k.length&&O.currentTime===0){n.requestTimeout(Ce,100);return}Ue()}()},getCropDimensions:function(){var e=arguments.length>0&&arguments[0]!==E?arguments[0]:{},a=e.videoWidth,i=e.videoHeight,r=e.gifWidth,l=e.gifHeight,s={width:0,height:0,scaledWidth:0,scaledHeight:0};return a>i?(s.width=Math.round(a*(l/i))-r,s.scaledWidth=Math.round(s.width*(i/l))):(s.height=Math.round(i*(r/a))-l,s.scaledHeight=Math.round(s.height*(a/r))),s}},X={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function t(e){t.attempts=t.attempts||0;var a=e.cameraStream,i=e.completedCallback,r=e.videoElement;r&&(r.videoWidth>0&&r.videoHeight>0?(r.removeEventListener("loadeddata",X.findVideoSize),i({videoElement:r,cameraStream:a,videoWidth:r.videoWidth,videoHeight:r.videoHeight})):t.attempts<10?(t.attempts+=1,n.requestTimeout(function(){X.findVideoSize(e)},400)):i({videoElement:r,cameraStream:a,videoWidth:X.defaultVideoDimensions.width,videoHeight:X.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){n.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var a=n.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,i=e.cameraStream,r=e.completedCallback,l=e.streamedCallback,s=e.videoElement;if(n.isFunction(l)&&l(),a){if(n.isString(a))s.src=a,s.innerHTML='<source src="'+a+'" type="video/'+n.getExtension(a)+'" />';else if(a instanceof Blob){try{s.src=n.URL.createObjectURL(a)}catch{}s.innerHTML='<source src="'+a+'" type="'+a.type+'" />'}}else if(s.mozSrcObject)s.mozSrcObject=i;else if(n.URL)try{s.srcObject=i,s.src=n.URL.createObjectURL(i)}catch{s.srcObject=i}s.play(),n.requestTimeout(function o(){o.count=o.count||0,X.loadedData===!0?(X.findVideoSize({videoElement:s,cameraStream:i,completedCallback:r}),X.loadedData=!1):(o.count+=1,o.count>10?X.findVideoSize({videoElement:s,cameraStream:i,completedCallback:r}):o())},0)},startStreaming:function(e){var a=n.isFunction(e.error)?e.error:n.noop,i=n.isFunction(e.streamed)?e.streamed:n.noop,r=n.isFunction(e.completed)?e.completed:n.noop,l=e.crossOrigin,s=e.existingVideo,o=e.lastCameraStream,c=e.options,v=e.webcamVideoElement,b=n.isElement(s)?s:v||q.createElement("video");l&&(b.crossOrigin=c.crossOrigin),b.autoplay=!0,b.loop=!0,b.muted=!0,b.addEventListener("loadeddata",function(y){X.loadedData=!0,c.offset&&(b.currentTime=c.offset)}),s?X.stream({videoElement:b,existingVideo:s,completedCallback:r}):o?X.stream({videoElement:b,cameraStream:o,streamedCallback:i,completedCallback:r}):n.getUserMedia({video:!0},function(y){X.stream({videoElement:b,cameraStream:y,streamedCallback:i,completedCallback:r})},a)},startVideoStreaming:function(e){var a=arguments.length>1&&arguments[1]!==E?arguments[1]:{},i=a.timeout!==E?a.timeout:0,r=a.callback,l=a.webcamVideoElement,s=void 0;i>0&&(s=n.requestTimeout(function(){X.onStreamingTimeout(r)},1e4)),X.startStreaming({error:function(){r({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(s)},completed:function(){var c=arguments.length>0&&arguments[0]!==E?arguments[0]:{},v=c.cameraStream,b=c.videoElement,y=c.videoHeight,p=c.videoWidth;e({cameraStream:v,videoElement:b,videoHeight:y,videoWidth:p})},lastCameraStream:a.lastCameraStream,webcamVideoElement:l,crossOrigin:a.crossOrigin,options:a})},stopVideoStreaming:function(e){e=n.isObject(e)?e:{};var a=e,i=a.keepCameraOn,r=a.videoElement,l=a.webcamVideoElement,s=e.cameraStream||{},o=s.getTracks?s.getTracks()||[]:[],c=!!o.length,v=o[0];!i&&c&&n.isFunction(v.stop)&&v.stop(),n.isElement(r)&&!l&&(r.pause(),n.isFunction(n.URL.revokeObjectURL)&&!n.webWorkerError&&r.src&&n.URL.revokeObjectURL(r.src),n.removeElement(r))}};function Ge(t){t=n.isObject(t)?t:{},X.stopVideoStreaming(t)}function ze(t,e){var a=t.options||{},i=a.images,r=a.video,l=Number(a.gifWidth),s=Number(a.gifHeight);Number(a.numFrames);var o=t.cameraStream,c=t.videoElement,v=t.videoWidth,b=t.videoHeight,y=Te.getCropDimensions({videoWidth:v,videoHeight:b,gifHeight:s,gifWidth:l}),p=e;a.crop=y,a.videoElement=c,a.videoWidth=v,a.videoHeight=b,a.cameraStream=o,n.isElement(c)&&(c.width=l+y.width,c.height=s+y.height,a.webcamVideoElement||(n.setCSSAttr(c,{position:"fixed",opacity:"0"}),q.body.appendChild(c)),c.play(),Te.getGIF(a,function(m){(!i||!i.length)&&(!r||!r.length)&&Ge(m),p(m)}))}function Qe(){var t=arguments.length>0&&arguments[0]!==E?arguments[0]:{},e=t.callback,a=t.existingVideo,i=t.options,r={getUserMedia:!0,"window.URL":!0},l=B.validate(r),s=void 0,o=void 0;if(l.error)return e(l);if(n.isElement(a)&&a.src){if(o=a.src,s=n.getExtension(o),!n.isSupported.videoCodecs[s])return e(B.messages.videoCodecs)}else n.isArray(a)&&n.each(a,function(c,v){if(v instanceof Blob?s=v.type.substr(v.type.lastIndexOf("/")+1,v.length):s=v.substr(v.lastIndexOf(".")+1,v.length),n.isSupported.videoCodecs[s])return a=v,!1});X.startStreaming({completed:function(v){v.options=i||{},ze(v,e)},existingVideo:a,crossOrigin:i.crossOrigin,options:i})}function Ke(){var t=arguments.length>0&&arguments[0]!==E?arguments[0]:{},e=t.callback,a=t.lastCameraStream,i=t.options,r=t.webcamVideoElement;if(!ke())return e(B.validate());if(i.savedRenderingContexts.length){Te.getGIF(i,function(l){e(l)});return}X.startVideoStreaming(function(){var l=arguments.length>0&&arguments[0]!==E?arguments[0]:{};l.options=i||{},ze(l,e)},{lastCameraStream:a,callback:e,webcamVideoElement:r,crossOrigin:i.crossOrigin})}function He(t,e){if(e=n.isFunction(t)?t:e,t=n.isObject(t)?t:{},!!n.isFunction(e)){var a=n.mergeOptions(me,t)||{},i=t.cameraStream,r=a.images,l=r?r.length:0,s=a.video,o=a.webcamVideoElement;a=n.mergeOptions(a,{gifWidth:Math.floor(a.gifWidth),gifHeight:Math.floor(a.gifHeight)}),l?Xe({images:r,imagesLength:l,callback:e,options:a}):s?Qe({existingVideo:s,callback:e,options:a}):Ke({lastCameraStream:i,callback:e,webcamVideoElement:o,options:a})}}function Ze(t,e){if(e=n.isFunction(t)?t:e,t=n.isObject(t)?t:{},!!n.isFunction(e)){var a=n.mergeOptions(me,t),i=n.mergeOptions(a,{interval:.1,numFrames:1,gifWidth:Math.floor(a.gifWidth),gifHeight:Math.floor(a.gifHeight)});He(i,e)}}var Pe={utils:$,error:fe,defaultOptions:_e,createGIF:He,takeSnapShot:Ze,stopVideoStreaming:Ge,isSupported:Ie,isWebCamGIFSupported:ke,isExistingVideoGIFSupported:Ae,isExistingImagesGIFSupported:ye,VERSION:"0.4.5"};typeof E=="function"&&E.amd?E([],function(){return Pe}):ue.exports=Pe})(typeof window<"u"?window:{},typeof document<"u"?document:{createElement:function(){}},typeof window<"u"?window.navigator:{})})(qe);var dt=qe.exports;const Le=ue=>(at("data-v-b9bed5cd"),ue=ue(),it(),ue),vt={class:"page-container"},ft=Le(()=>P("h1",null,'"今天单推谁"GIF生成器',-1)),mt={id:"input-container"},ut={id:"modes-settings"},gt=Le(()=>P("span",{id:"matching-hint"},"类型选择: ",-1)),ht={class:"radio-group"},pt=["checked","value","id","onChange"],xt=["for"],bt={class:"character-grid"},Ct=["onClick"],kt={id:"modes-settings"},yt=Le(()=>P("span",{id:"matching-hint"},"快捷选项: ",-1)),St={class:"checkbox-group"},wt=["onUpdate:modelValue","id"],Ft=["for"],Et={id:"image-container-wrapper"},Wt={key:0,style:{"text-align":"center",display:"block",margin:"20px 0"}},_t={key:1,class:"result-box"},It=["src"],At="bold 50px KaiTi",je="images/",Ne="white",Tt="black",Rt="今天单推谁？",Ut={__name:"GIFMemeEditor",setup(ue){const re=ce(null),U=ce([]),q=ce(!1),J=ce(null),E=ce(!0);ce(!1);const n=new nt("KaiTi"),$=ce(lt),B=ce(ct),fe=ce([{name:"角色",mark:E}]);let ae,me;async function _e(){E.value?me=je+"characters/":me=je+"seiyuus/",ot(ae,Tt,At,!1,210,75,Rt),J.value=null,U.value=[],q.value=!0;for(let C=0;C<$.value.length;C++)if($.value[C].checked){const T=$.value[C],_=await st(me+T.Eng+".png");ae.drawImage(_,48,130,300,300);const ie=re.value.toDataURL("image/png");U.value.push(ie),ae.fillStyle=Ne,ae.fillRect(48,130,re.value.width,re.value.height)}if(U.value.length===0){q.value=!1,alert("请至少选择一个角色！");return}Ie()}const Ie=()=>{dt.createGIF({images:U.value,gifWidth:re.value.width,gifHeight:re.value.height},function(C){C.error||(q.value=!1,J.value=C.image)})};function ke(){if(!J.value)return;const C=document.createElement("a");C.href=J.value,C.download="今天单推谁.gif",C.click()}$e(async()=>{try{await Promise.all([n.check()]),ae=re.value.getContext("2d"),ae.fillStyle=Ne,ae.fillRect(0,0,re.value.width,re.value.height)}catch(C){console.error(C)}});const ye=()=>{for(let C=0;C<$.value.length;C++)$.value[C].checked=!1;for(let C=0;C<B.value.length;C++)B.value[C].checked=!1;J.value=null},Ae=C=>{for(let T=0;T<$.value.length;T++)$.value[T].checked=!1;for(let T=0;T<C.length;T++)if(C[T].checked)for(let _=0;_<C[T].char.length;_++){const ie=C[T].char[_];$.value[ie].checked=!0}},Se=C=>{for(let T=0;T<fe.value.length;T++)fe.value[T].name!=C.name?fe.value[T].mark=!1:fe.value[T].mark=!0;ye()},we=C=>{for(let T=0;T<B.value.length;T++)B.value[T].checked=!1;C.checked=!C.checked};return(C,T)=>(de(),ve("div",vt,[ft,P("div",mt,[P("div",ut,[gt,P("div",ht,[(de(!0),ve(Me,null,Ve(fe.value,_=>(de(),ve("div",{key:_.name,class:"radio-item"},[P("input",{type:"radio",name:"check",checked:_.mark,value:_.mark,id:_.name,onChange:ie=>Se(_)},null,40,pt),P("label",{for:_.name},Oe(_.name),9,xt)]))),128))])]),P("div",bt,[(de(!0),ve(Me,null,Ve($.value,_=>(de(),ve("div",{key:_.label,class:et(["grid-item",{character_selected:_.checked}]),onClick:ie=>we(_)},Oe(_.label),11,Ct))),128))]),P("div",kt,[yt,P("div",St,[(de(!0),ve(Me,null,Ve(B.value,_=>(de(),ve("div",{key:_.label,class:"checkbox-item"},[tt(P("input",{"onUpdate:modelValue":ie=>_.checked=ie,type:"checkbox",id:_.label,onChange:T[0]||(T[0]=ie=>Ae(B.value))},null,40,wt),[[rt,_.checked]]),P("label",{for:_.label},Oe(_.label),9,Ft)]))),128))])]),P("div",{id:"button-container"},[P("button",{onClick:_e,class:"btns primary-btn"},"绘制GIF图"),P("button",{onClick:ye,class:"btns reset-btn"},"清空选择"),P("button",{onClick:ke,class:"btns download-btn"},"下载GIF图")])]),P("div",Et,[P("canvas",{id:"GIF-canvas",ref_key:"canvas",ref:re,width:"400",height:"500",style:{display:"none"}},null,512),q.value?(de(),ve("span",Wt,"生成中······")):Be("",!0),J.value?(de(),ve("div",_t,[P("img",{src:J.value,class:"generated-gif",alt:"Result GIF"},null,8,It)])):Be("",!0)])]))}},Gt=Je(Ut,[["__scopeId","data-v-b9bed5cd"]]);export{Gt as default};
